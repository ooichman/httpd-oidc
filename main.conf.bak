<VirtualHost *:*>
	ServerAdmin webmaster@infra.local
	DocumentRoot /var/www/html
	ErrorLog /var/log/httpd/error.log
	CustomLog /var/log/httpd/access.log combined

    # OpenID Connect metadata for dataporten.
    OIDCProviderMetadataURL https://sso-rhsso73-main.apps.infra.local/auth/realms/mydom-main/.well-known/openid-configuration
    OIDCSSLValidateServer Off

    # These are Client ID and Client Secret from the OAuth details page on dashboard.dataporten.no
    OIDCClientID httpd-openidc
    OIDCClientSecret eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI3ODk4MjM0Ni0xN2M5LTRlNmEtYTExOS1mODYyNWMzY2M0ZjIifQ.eyJqdGkiOiI5OGU3Y2M4MC1iY2I0LTQyM2QtOTE5My01ZmRiYmY3YzlmZDUiLCJleHAiOjAsIm5iZiI6MCwiaWF0IjoxNTY3NDUzMTEyLCJpc3MiOiJodHRwczovL3Nzby1yaHNzbzczLW1haW4uYXBwcy5pbmZyYS5sb2NhbC9hdXRoL3JlYWxtcy9teWRvbS1tYWluIiwiYXVkIjoiaHR0cHM6Ly9zc28tcmhzc283My1tYWluLmFwcHMuaW5mcmEubG9jYWwvYXV0aC9yZWFsbXMvbXlkb20tbWFpbiIsInR5cCI6IkluaXRpYWxBY2Nlc3NUb2tlbiJ9.mPjEBfpJ8lqlSHTz7Roh4UzTKxGXX42zRs9QQ0qWUOE

    # Scopes to request. These must be activated in dashboard.dataporten.no first
    OIDCScope "openid email"

    # Session cookie encryption key
    OIDCCryptoPassphrase GenerateNewPassword

    # Try uncommenting this if you get errors like these "OpenID Connect Provider error: Error in handling response type."
    # OIDCProviderTokenEndpointAuth client_secret_post

    # Needs to match exactly redirect URI registered in dashboard.dataporten.no
    OIDCRedirectURI http://httpd-openidc.infra.local/redirect_uri
    <Location "/">
        AuthType openid-connect
        Require valid-user
    </Location>
</VirtualHost>
